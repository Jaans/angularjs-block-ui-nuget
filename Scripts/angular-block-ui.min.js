/*!
   angular-block-ui v0.0.10
   (c) 2014 (null) McNull https://github.com/McNull/angular-block-ui
   License: MIT
*/
(function(n){var t=n.module("blockUI",[]);t.config(["$provide","$httpProvider",function(n,t){n.decorator("$exceptionHandler",["$delegate","$injector",function(n,t){var i,r;return function(u,f){r=r||t.get("blockUIConfig");r.resetOnException&&(i=i||t.get("blockUI"),i.instances.reset());n(u,f)}}]);t.interceptors.push("blockUIHttpInterceptor")}]);t.run(["$document","blockUIConfig",function(n,t){t.autoInjectBodyBlock&&n.find("body").append('<div block-ui="main"><\/div>')}]);t.provider("blockUIConfig",function(){var t={templateUrl:"angular-block-ui/angular-block-ui.ng.html",delay:250,message:"Loading ...",autoBlock:!0,resetOnException:!0,requestFilter:n.noop,autoInjectBodyBlock:!0};this.templateUrl=function(n){t.templateUrl=n};this.template=function(n){t.template=n};this.delay=function(n){t.delay=n};this.message=function(n){t.message=n};this.autoBlock=function(n){t.autoBlock=n};this.resetOnException=function(n){t.resetOnException=n};this.requestFilter=function(n){t.requestFilter=n};this.autoInjectBodyBlock=function(n){t.autoInjectBodyBlock=n};this.$get=function(){return t}});t.directive("blockUi",["blockUI","blockUIConfig","blockUiLinkFn",function(n,t,i){return{scope:!0,restrict:"A",templateUrl:t.template?undefined:t.templateUrl,template:t.template,link:i}}]).factory("blockUiLinkFn",["blockUI","blockUIUtils",function(n,t){return function(i,r,u){var e=r.parent(),f,h,c,o,s,l;e.length&&(f=n,e[0].tagName==="BODY"?h=i.$on("$viewContentLoaded",function(){h();i.$on("$locationChangeStart",function(n){i.state.blockCount>0&&n.preventDefault()})}):(e.css("position","relative"),c=u.blockUi?u.blockUi:"_"+i.$id,f=n.instances.get(c),o=r.inheritedData("block-ui"),o&&(f._parent=o),s=u.blockUiPattern,s&&(l=t.buildRegExp(s),f.pattern(l)),i.$on("$destroy",function(){f.release()}),f.addRef()),r.addClass("block-ui"),e.data("block-ui",f),i.state=f.state(),i.$watch("state.blocking",function(n){e.attr("aria-busy",n)}))}}]);t.factory("blockUIHttpInterceptor",["$q","$injector","blockUIConfig",function(n,t,i){function u(){r=r||t.get("blockUI")}function f(n){i.autoBlock&&!n.$_noBlock&&n.$_blocks&&(u(),n.$_blocks.stop())}function e(t){return f(t.config),n.reject(t)}var r;return{request:function(n){return i.autoBlock&&(i.requestFilter(n)===!1?n.$_noBlock=!0:(u(),n.$_blocks=r.instances.locate(n),n.$_blocks.start())),n},requestError:e,response:function(n){return f(n.config),n},responseError:e}}]);t.factory("blockUI",["blockUIConfig","$timeout","blockUIUtils","$document",function(t,i,r,u){function s(f){var s=this,h={id:f,blockCount:0,message:t.message,blocking:!1},c,l=[];this._refs=0;this.start=function(f){h.message=f||t.message;h.blockCount++;var e=n.element(u[0].activeElement);e.length&&r.isElementInBlockScope(e,s)&&(s._restoreFocus=e[0],i(function(){s._restoreFocus&&s._restoreFocus.blur()}));c||(c=i(function(){c=null;h.blocking=!0},t.delay))};this._cancelStartTimeout=function(){c&&(i.cancel(c),c=null)};this.stop=function(){h.blockCount=Math.max(0,--h.blockCount);h.blockCount===0&&s.reset(!0)};this.message=function(n){h.message=n};this.pattern=function(n){return n!==undefined&&(s._pattern=n),s._pattern};this.reset=function(t){s._cancelStartTimeout();h.blockCount=0;h.blocking=!1;s._restoreFocus&&(!u[0].activeElement||u[0].activeElement===o[0])&&(s._restoreFocus.focus(),s._restoreFocus=null);try{t&&n.forEach(l,function(n){n()})}finally{l.length=0}};this.done=function(n){l.push(n)};this.state=function(){return h};this.addRef=function(){s._refs+=1};this.release=function(){--s._refs<=0&&e.instances._destroy(s)}}var o=u.find("body"),f=[],e;return f.get=function(n){var t=f[n];return t||(t=f[n]=new s(n),f.push(t)),t},f._destroy=function(t){if(n.isString(t)&&(t=f[t]),t){t.reset();delete f[t.state().id];for(var i=f.length;--i;)if(f[i]===t){f.splice(i,1);break}}},f.locate=function(n){var t=[],i,u,o;for(r.forEachFnHook(t,"start"),r.forEachFnHook(t,"stop"),i=f.length;i--;)u=f[i],o=u._pattern,o&&o.test(n.url)&&t.push(u);return t.length===0&&t.push(e),t},r.forEachFnHook(f,"reset"),e=f.get("main"),e.addRef(),e.instances=f,e}]);t.factory("blockUIUtils",function(){var n={buildRegExp:function(n){var t=n.match(/^\/(.*)\/([gim]*)$/),i;if(t)i=new RegExp(t[1],t[2]);else throw Error("Incorrect regular expression format: "+n);return i},forEachFn:function(n,t,i){for(var u=n.length,r;u--;)r=n[u],r[t].apply(r,i)},forEachFnHook:function(t,i){t[i]=function(){n.forEachFn(this,i,arguments)}},isElementInBlockScope:function(n,t){for(var i=n.inheritedData("block-ui");i;){if(i===t)return!0;i=i._parent}return!1}};return n});n.module("blockUI").run(["$templateCache",function(n){n.put("angular-block-ui/angular-block-ui.ng.html",'<div ng-show="state.blockCount > 0" class="block-ui-overlay" ng-class="{ \'block-ui-visible\': state.blocking }"><\/div><div ng-show="state.blocking" class="block-ui-message-container" aria-live="assertive" aria-atomic="true"><div class="block-ui-message">{{ state.message }}<\/div><\/div>')}])})(angular);
/*
//# sourceMappingURL=angular-block-ui.min.js.map
*/